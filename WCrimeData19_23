getwd()
setwd("/Users/amartinez/Documents/CSULB/Service/LBDS/Data")

df <- read.csv(file.choose())
head(df)
tail(df)
# transpose of dataframe 
transpose <- t(df)

# converting the result to dataframe
transpose <- as.data.frame(transpose)

# calculating reverse of dataframe
rev_df <- rev(transpose)

# transpose of reverse dataframe 
rev_df <- t(rev_df)

# converting the result to dataframe
rev_df <- as.data.frame(rev_df)

head(df)

df1 <- read.csv(file.choose())
head(df1)
# transpose of dataframe 
transpose1 <- t(df1)

# converting the result to dataframe
transpose1 <- as.data.frame(transpose1)

# calculating reverse of dataframe
rev_df1 <- rev(transpose1)

# transpose of reverse dataframe 
rev_df1 <- t(rev_df1)

# converting the result to dataframe
rev_df1 <- as.data.frame(rev_df1)
head(rev_df)
head(rev_df1)

# Merge two data sets into one ordered from 2019-2023
cd <- rbind(rev_df1, rev_df)
head(cd)
tail(cd)

###############
rm(df, df1, rev_df, rev_df1, transpose, transpose1)
backup <- cd

#Recode for just the year
cd$YEAR <- as.integer(format(as.POSIXct(cd$REPDATETIME, format = "%m/%d/%Y %H:%M"), "%Y"))

head(cd)
summary(cd)
cd$CHARGE <- as.factor(cd$CHARGE)
cd$CHARGE_LITERAL <- as.factor(cd$CHARGE_LITERAL)
cd$YEAR <- as.factor(cd$YEAR)
cd$BEAT <- as.factor(cd$BEAT)
cd$JUV_OFFENDER <- as.factor(cd$JUV_OFFENDER)
summary(cd)
str(cd)

charges <- unique(cd$CHARGE_LITERAL)
charges

#####################
# Recoding charge_literal crimes into broader categories
# Create a function to categorize charges
categorize_crime <- function(charge) {
  if (charge %in% c(
    
  )) {
    return("Crimes against Property")
  } else if (charge %in% c(
    "Grand Theft; Motor Vehicle", 
  )) {
    return("Crimes against Persons")
  } else if (charge %in% c(
    
  )) {
    return("Crimes against Public Order and Morals")
  } else {
    return("Other")
  }
}

# Apply the function to create a new column
df$crime_category <- sapply(df$Charge, categorize_crime)
